(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-bd74b288"],{"0044":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{attrs:{spinning:t.loading}},[a("a-card",{staticClass:"card",attrs:{title:t.$t("task.edit_card"),bordered:!1}},[a("a-form",{staticClass:"form",attrs:{form:t.form}},[a("a-form-item",t._b({attrs:{label:t.$t("task.task_code")}},"a-form-item",t.formItemLayout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["code",{initialValue:t.data.code,rules:[{required:!0,message:t.$t("task.code_msg1")}]}],expression:"[\n              'code',\n              {initialValue: data.code,rules: [{required: true,message: $t('task.code_msg1')}]}\n            ]"}],staticStyle:{width:"220px"},attrs:{placeholder:t.$t("task.code_placeholder"),disabled:"1"!=t.params.opType}})],1),a("a-form-item",t._b({attrs:{label:t.$t("task.task_name")}},"a-form-item",t.formItemLayout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["description",{initialValue:t.data.description,rules:[{required:!0,message:t.$t("task.description_msg1")}]}],expression:"[\n              'description',\n              {initialValue: data.description,rules: [{required: true,message: $t('task.description_msg1')}]}\n            ]"}],attrs:{placeholder:t.$t("task.task_name_placeholder")}})],1),a("a-form-item",t._b({attrs:{label:t.$t("task.type")}},"a-form-item",t.formItemLayout,!1),[a("dict",{directives:[{name:"decorator",rawName:"v-decorator",value:["type",{initialValue:[t.data.type],rules:[{required:!0,message:t.$t("task.type_msg1"),validator:function(e,a,s){return a&&a[0]?s():s(t.$t("task.type_msg1"))}}]}],expression:"[\n              'type',\n              {initialValue: [data.type],rules: [{required: true,message: $t('task.type_msg1'),validator: (rule, value, callback)=>value&&value[0]?callback():callback($t('task.type_msg1')) }]}\n            ]"}],staticStyle:{width:"220px"},attrs:{isPublic:!0,type:"TASK_TYPE"},on:{change:t.taskTypeSelect},model:{value:t.taskType,callback:function(e){t.taskType=e},expression:"taskType"}})],1),a("a-form-item",t._b({attrs:{label:t.$t("task.work_cycle")}},"a-form-item",t.formItemLayout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["cycle",{initialValue:t.data.cycle,rules:[{required:!0,message:t.$t("task.cycle_msg1")}]}],expression:"[\n              'cycle',\n              {initialValue: data.cycle,rules: [{required: true,message: $t('task.cycle_msg1')}]}\n            ]"}],staticStyle:{width:"220px"},attrs:{type:"number",placeholder:t.$t("task.cycle_placeholder")}},[a("dict",{directives:[{name:"decorator",rawName:"v-decorator",value:["cycleType",{initialValue:[t.data.cycleType]}],expression:"[\n                'cycleType',\n                {initialValue: [data.cycleType]}\n              ]"}],staticStyle:{width:"80px"},attrs:{slot:"addonAfter",isPublic:!0,type:"REPEAT_TYPE"},on:{change:t.cycleTypeSelect},slot:"addonAfter",model:{value:t.cycleType,callback:function(e){t.cycleType=e},expression:"cycleType"}})],1)],1),a("a-form-item",t._b({attrs:{label:t.$t("task.base_time")}},"a-form-item",t.formItemLayout,!1),[a("pick-time",{directives:[{name:"decorator",rawName:"v-decorator",value:["baseTime",{initialValue:t.data.baseTime,rules:[{required:!0,message:t.$t("task.base_time_msg1")}]}],expression:"[\n              'baseTime',\n              {initialValue: data.baseTime,rules: [{required: true,message: $t('task.base_time_msg1')}]}\n            ]"}],staticStyle:{width:"220px !important",display:"inline-block"},attrs:{defaultValue:t.data.baseTime},on:{change:function(e){t.data.baseTime=e}}})],1),a("a-form-item",t._b({attrs:{label:t.$t("task.next_time")}},"a-form-item",t.formItemLayout,!1),[a("pick-time",{directives:[{name:"decorator",rawName:"v-decorator",value:["nextTime",{initialValue:t.data.nextTime,rules:[{required:!0,message:t.$t("task.next_time_msg1")}]}],expression:"[\n              'nextTime',\n              {initialValue: data.nextTime,rules: [{required: true,message: $t('task.next_time_msg1')}]}\n            ]"}],staticStyle:{width:"220px !important",display:"inline-block"},attrs:{defaultValue:t.data.nextTime},on:{change:function(e){t.data.nextTime=e}}})],1),a("a-form-item",t._b({attrs:{label:t.$t("task.edit_work_id")}},"a-form-item",t.formItemLayout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["wsId",{initialValue:t.data.wsId,rules:[{required:!0,message:t.$t("task.ws_id_msg1")}]}],expression:"[\n              'wsId',\n              {initialValue: data.wsId,rules: [{required: true,message: $t('task.ws_id_msg1')}]}\n            ]"}],attrs:{placeholder:t.$t("task.ws_id_placeholder")}})],1),a("a-form-item",t._b({attrs:{label:t.$t("task.params")}},"a-form-item",t.formItemLayout,!1),[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["params",{initialValue:t.data.params}],expression:"[\n              'params',\n              {initialValue: data.params}\n            ]"}],attrs:{rows:"10",placeholder:t.$t("task.params_placeholder")}})],1)],1)],1)],1),a("footer-tool-bar",{style:{width:"100%"}},[a("a-button",{on:{click:t.onCancel}},[t._v(t._s(t.$t("common.btn_cancel")))]),t._v("  \n    "),"3"!=t.params.opType?a("a-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v(t._s(t.$t("common.btn_ok")))]):t._e()],1)],1)},i=[],n=a("b775"),r=a("e59a"),l=a("5a70"),o=a("56cd"),c={components:{Dict:r["a"],FooterToolBar:l["a"],notification:o["a"]},data:function(){return{taskType:"",cycleType:"",loading:!1,form:this.$form.createForm(this),data:{},formItemLayout:{labelCol:{lg:{span:7},sm:{span:7}},wrapperCol:{lg:{span:14},sm:{span:14}}}}},props:{params:{type:Object,default:null}},mounted:function(){this.initModel()},methods:{taskTypeSelect:function(t){this.taskType=t?t[0]:""},cycleTypeSelect:function(t){this.cycleType=t?t[0]:""},initModel:function(){"2"!=this.params.opType&&"3"!=this.params.opType||this.initData()},initData:function(){var t=this;t.loading=!0,Object(n["b"])({url:"2"==t.params?"/sys/task/update-load":"/sys/task/detail",method:"get",params:{code:t.params.code}}).then(function(e){t.loading=!1,t.data=e.result,t.cycleType=[t.data.cycleType]})},onSubmit:function(){var t=this;this.form.validateFields(function(e,a){if(!e){var s=t;if(s.data=Object.assign(s.data,a),s.data.cycleType&&(s.data.cycleType=s.data.cycleType[0]),s.data.type=s.data.type[0],!s.params)return;if(""==s.cycleType){var i=[{message:s.$t("task.cycle_type_msg1"),field:"cycle"}];return void t.form.setFields({cycle:{errors:i}})}s.loading=!0,Object(n["b"])({url:"1"==s.params.opType?"/sys/task/insert":"/sys/task/update",method:"post",params:s.data}).then(function(e){s.loading=!1,e&&t.$emit("ok",e)})}})},onCancel:function(){this.$emit("cancel")}}},d=c,u=(a("11cf"),a("2877")),m=Object(u["a"])(d,s,i,!1,null,"07719a9e",null);e["a"]=m.exports},"11cf":function(t,e,a){"use strict";var s=a("cc50"),i=a.n(s);i.a},"122b":function(t,e,a){},"127c":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=this,a=e.$createElement,s=e._self._c||a;return s("a-spin",{attrs:{spinning:e.loading,tip:e.$t("task.tip"),size:"large"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:!e.isEdit,expression:"!isEdit"}],attrs:{bordered:!1}},[s("transition",{attrs:{name:"fade"}},[s("a-card",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],staticStyle:{"background-color":"#fff8db","margin-bottom":"10px"}},[s("div",{staticClass:"table-page-search-wrapper"},[e.reset_flag?s("a-form",{attrs:{layout:"inline"}},[s("a-row",{attrs:{gutter:48}},[s("a-col",{attrs:{md:6,sm:24}},[s("a-form-item",{attrs:{label:e.$t("task.task_code")}},[s("a-input",{attrs:{placeholder:e.$t("task.code_placeholder")},model:{value:e.queryParam.code,callback:function(t){e.$set(e.queryParam,"code",t)},expression:"queryParam.code"}})],1)],1),s("a-col",{attrs:{md:6,sm:24}},[s("a-form-item",{attrs:{label:e.$t("task.task_name")}},[s("a-input",{attrs:{placeholder:e.$t("task.task_name_placeholder")},model:{value:e.queryParam.description,callback:function(t){e.$set(e.queryParam,"description",t)},expression:"queryParam.description"}})],1)],1),s("a-col",{attrs:{md:6,sm:24}},[s("a-form-item",{attrs:{label:e.$t("task.actived")}},[s("dict",{ref:"taskActived",attrs:{isPublic:!0,type:"TASK_ACTIVED"},on:{change:function(t){t?e.queryParam.actived=t[0]:delete e.queryParam.actived}}})],1)],1),s("a-col",{attrs:{md:6,sm:24}},[s("btn-search",{attrs:{showInput:!1},on:{click:e.onSearch}}),s("a-button",{staticStyle:{"margin-left":"8px"},on:{click:e.onReset}},[e._v(e._s(e.$t("common.btn_reset")))])],1)],1)],1):e._e()],1)])],1),s("a-card",[s("div",{staticClass:"table-page-search-wrapper",staticStyle:{"margin-bottom":"10px"}},[s("a-row",[s("a-col",{attrs:{md:19,sm:19}},[s("btn-add",{attrs:{type:"bt",text:e.$t("task.add_task")},on:{click:e.onAdd}})],1),s("a-col",{attrs:{md:5,sm:5}},[s("sorter",{on:{refresh:e.onSearch,show:e.showSearch}})],1)],1)],1),s("s-table",{ref:"table",attrs:{bordered:!1,autoLoad:!0,data:e.loadData,size:"small",rowKey:"code"},on:{onClick:function(t){e.$refs.planTable.init(t.code)}}},[s("a-table-column",{attrs:{title:this.$t("task.index1"),align:"center",width:"50px"},scopedSlots:e._u([{key:"default",fn:function(t){return s("span",{},[s("a-icon",{staticClass:"icon",staticStyle:{"font-size":"25px"},attrs:{type:"schedule",theme:"twoTone"}})],1)}}])}),s("a-table-column",{attrs:{title:this.$t("task.code"),dataIndex:"code",align:"left",width:"60px"}}),s("a-table-column",{attrs:{title:this.$t("task.task_name"),dataIndex:"description",align:"left",width:"280px"}}),s("a-table-column",{attrs:{title:this.$t("task.work_id"),dataIndex:"wsId",align:"left",width:"140px"}}),s("a-table-column",{attrs:{title:this.$t("task.type"),dataIndex:"type",align:"left",width:"100px",customRender:function(e){return e?t.$refs.taskType.getLabel(e):""}}}),s("a-table-column",{attrs:{title:this.$t("task.work_cycle"),dataIndex:"cycle",align:"left",width:"130px"},scopedSlots:e._u([{key:"default",fn:function(t,a){return s("span",{},[e._v("\n            "+e._s(a.cycle+" "+e.$refs.cycleType.getLabel(a.cycleType))+"\n          ")])}}])}),s("a-table-column",{attrs:{title:this.$t("task.base_time"),dataIndex:"baseTime",align:"left",width:"160px"},scopedSlots:e._u([{key:"default",fn:function(t,e){return s("span",{},[s("pick-label",{attrs:{defaultValue:e.baseTime}})],1)}}])}),s("a-table-column",{attrs:{title:this.$t("task.next_time"),dataIndex:"nextTime",align:"left",width:"160px"},scopedSlots:e._u([{key:"default",fn:function(t,e){return s("span",{},[s("pick-label",{attrs:{defaultValue:e.nextTime}})],1)}}])}),s("a-table-column",{attrs:{title:this.$t("task.actived"),dataIndex:"actived",align:"left",width:"80px"},scopedSlots:e._u([{key:"default",fn:function(t,a){return s("span",{},[s("btn-switch",{attrs:{defaultChecked:"Y"==a.actived,checkedChildren:e.$refs.taskActived.getLabel("Y"),unCheckedChildren:e.$refs.taskActived.getLabel("N")},on:{change:function(t){return e.onSwitch(t,a)}}})],1)}}])}),s("a-table-column",{attrs:{title:this.$t("task.action"),align:"left",dataIndex:"action"},scopedSlots:e._u([{key:"default",fn:function(t,a){return s("span",{},[s("btn-edit",{attrs:{type:"a"},on:{click:function(t){return e.onUpdate(a)}}}),s("a-divider",{attrs:{type:"vertical"}}),s("btn-remove",{attrs:{type:"a"},on:{click:function(t){return e.onRemove(a)}}})],1)}}])})],1),s("dict",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"cycleType",attrs:{type:"REPEAT_TYPE",isPublic:!0}}),s("dict",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"taskType",attrs:{type:"TASK_TYPE",isPublic:!0}})],1),s("a-card",{staticStyle:{"margin-top":"8px"},attrs:{title:e.$t("task.task_plan_list")}},[s("plan-list",{ref:"planTable"})],1)],1),e.isEdit?s("task-edit",{attrs:{params:e.editParams},on:{ok:e.onSubmit,cancel:e.onCancel}}):e._e()],1)},i=[],n=a("e8c4"),r=a("0044"),l=a("fa72"),o=a("e59a"),c=a("b775"),d={name:"Index",components:{STable:n["a"],TaskEdit:r["a"],PlanList:l["a"],Dict:o["a"]},data:function(){var t=this;return{loading:!1,reset_flag:!0,isEdit:!1,show:!0,editParams:{},queryParam:{},loadData:function(e){return Object(c["b"])({url:"/sys/task/search-list-task",method:"get",params:Object.assign(e,t.queryParam)}).then(function(e){return t.$refs.planTable.init(""),e.result})}}},methods:{onReset:function(){var t=this;t.queryParam={},t.reset_flag=!1,this.$nextTick(function(){t.reset_flag=!0})},onSearch:function(){this.$refs.table.refresh()},showSearch:function(){this.show=!this.show},onAdd:function(){this.editParams={opType:"1"},this.isEdit=!0},onUpdate:function(t){this.editParams={opType:"2",code:t.code},this.isEdit=!0},onDetail:function(t){this.editParams={opType:"3",code:t.code},this.isEdit=!0},onSwitch:function(t,e){var a=this;Object(c["b"])({url:"/sys/task/switch",method:"post",params:{code:e.code,actived:t?"Y":"N"}}).then(function(){a.$refs.table.refresh()})},onRemove:function(t){var e=this;Object(c["b"])({method:"delete",url:"/sys/task/delete",params:{code:t.code}}).then(function(){e.$refs.table.refresh()})},onSubmit:function(){this.isEdit=!1,this.$refs.table.refresh()},onCancel:function(){this.isEdit=!1}}},u=d,m=(a("9ab8"),a("2877")),p=Object(m["a"])(u,s,i,!1,null,null,null);e["default"]=p.exports},"9ab8":function(t,e,a){"use strict";var s=a("122b"),i=a.n(s);i.a},cc50:function(t,e,a){},fa72:function(t,e,a){"use strict";var s=function(){var t=this,e=this,a=e.$createElement,s=e._self._c||a;return s("div",[s("s-table",{ref:"table",attrs:{bordered:!1,autoLoad:!1,data:e.loadData,size:"small",rowKey:"code"}},[s("a-table-column",{attrs:{title:this.$t("task.index1"),align:"center",width:"50px"},scopedSlots:e._u([{key:"default",fn:function(t){return s("span",{},[s("a-icon",{staticClass:"icon",staticStyle:{"font-size":"25px"},attrs:{type:"schedule",theme:"twoTone"}})],1)}}])}),s("a-table-column",{attrs:{title:this.$t("task.plan_cdate"),dataIndex:"cdate",align:"left",width:"170px"},scopedSlots:e._u([{key:"default",fn:function(t,e){return s("span",{},[s("pick-label",{attrs:{defaultValue:e.cdate}})],1)}}])}),s("a-table-column",{attrs:{title:this.$t("task.plan_exectime"),dataIndex:"execTime",align:"left",width:"170px"},scopedSlots:e._u([{key:"default",fn:function(t,e){return s("span",{},[s("pick-label",{attrs:{defaultValue:e.execTime}})],1)}}])}),s("a-table-column",{attrs:{title:this.$t("task.plan_datatime"),dataIndex:"dataTime",align:"left",width:"170px"},scopedSlots:e._u([{key:"default",fn:function(t,e){return s("span",{},[s("pick-label",{attrs:{defaultValue:e.dataTime}})],1)}}])}),s("a-table-column",{attrs:{title:this.$t("task.plan_status"),dataIndex:"status",align:"left",width:"170px",customRender:function(e){return e?t.$refs.planStatus.getLabel(e):""}}}),s("a-table-column",{attrs:{title:this.$t("task.action"),align:"left",dataIndex:"action"},scopedSlots:e._u([{key:"default",fn:function(t,a){return s("span",{},[s("btn-edit",{attrs:{type:"a",text:e.$t("task.plan_reset")},on:{click:function(t){return e.onReset(a)}}}),s("a-divider",{attrs:{type:"vertical"}}),s("btn-detail",{attrs:{type:"a",text:e.$t("task.plan_detail")},on:{click:function(t){return e.onDetail(a)}}})],1)}}])})],1),s("dict",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"planStatus",attrs:{type:"TASK_PLAN_STATUS",isPublic:!0}}),s("record-list",{ref:"recordTable"})],1)},i=[],n=a("e8c4"),r=a("e59a"),l=a("b775"),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-modal",{attrs:{maskClosable:!1,"body-style":{padding:"10px"},title:t.$t("task.record_list"),width:800,cancelText:t.$t("common.btn_cancel1")},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[a("template",{slot:"footer"},[a("a-button",{key:"back",on:{click:t.handleCancel}},[t._v("\n      "+t._s(t.$t("task.close"))+"\n    ")])],1),a("div",{staticClass:"table-page-search-wrapper"},[a("s-table",{ref:"table",staticStyle:{"max-height":"500px","overflow-y":"auto"},attrs:{bordered:!1,autoLoad:!0,data:t.loadData,size:"small",rowKey:"sn"}},[a("a-table-column",{attrs:{title:this.$t("task.index1"),align:"center",width:"50px"},scopedSlots:t._u([{key:"default",fn:function(t){return a("span",{},[a("a-icon",{staticClass:"icon",staticStyle:{"font-size":"25px"},attrs:{type:"schedule",theme:"twoTone"}})],1)}}])}),a("a-table-column",{attrs:{title:this.$t("task.record_stime"),dataIndex:"startTime",align:"left",width:"140px"},scopedSlots:t._u([{key:"default",fn:function(t,e){return a("span",{class:"S"==e.result?"":"error"},[a("pick-label",{attrs:{defaultValue:e.startTime}})],1)}}])}),a("a-table-column",{attrs:{title:this.$t("task.record_etime"),dataIndex:"endTime",align:"left",width:"140px"},scopedSlots:t._u([{key:"default",fn:function(t,e){return a("span",{class:"S"==e.result?"":"error"},[a("pick-label",{attrs:{defaultValue:e.endTime}})],1)}}])}),a("a-table-column",{attrs:{title:this.$t("task.record_result"),dataIndex:"result",align:"left",width:"140px"},scopedSlots:t._u([{key:"default",fn:function(e,s){return a("span",{class:"S"==s.result?"":"error"},[a("span","S"==e?[t._v(t._s(t.$t("task.success")))]:[t._v(t._s(t.$t("task.fail")))])])}}])}),a("a-table-column",{attrs:{title:this.$t("task.record_remark"),dataIndex:"remark",align:"left"},scopedSlots:t._u([{key:"default",fn:function(e,s){return a("span",{class:"S"==s.result?"":"error"},[t._v("\n          "+t._s(e)+"\n        ")])}}])})],1)],1)],2)},c=[],d={components:{STable:n["a"]},data:function(){var t=this;return{visible:!1,queryParam:{},loadData:function(e){return Object(l["b"])({url:"/sys/task/search-list-record",method:"get",params:Object.assign(e,t.queryParam)}).then(function(t){return t.result})}}},methods:{showModal:function(t){this.visible=!0,this.queryParam.code=t,this.$refs.table.refresh()},handleCancel:function(){this.visible=!1}}},u=d,m=a("2877"),p=Object(m["a"])(u,o,c,!1,null,null,null),f=p.exports,h={name:"Index",components:{STable:n["a"],Dict:r["a"],RecordList:f},data:function(){var t=this;return{queryParam:{},loadData:function(e){return Object(l["b"])({url:"/sys/task/search-list-plan",method:"get",params:Object.assign(e,t.queryParam)}).then(function(t){return t.result})}}},methods:{init:function(t){this.queryParam.taskCode!=t&&(this.queryParam.taskCode=t,this.$refs.table.refresh())},onDetail:function(t){this.$refs.recordTable.showModal(t.code)},onReset:function(t){var e=this;e.$confirm({title:e.$t("task.plan_msg1"),content:e.$t("task.plan_msg2"),okType:"danger",onOk:function(){var a=this;Object(l["b"])({url:"/sys/task/update-reset",method:"post",params:{code:t.code}}).then(function(t){e.loading=!1,t&&a.$emit("ok",t)})}})}}},y=h,b=Object(m["a"])(y,s,i,!1,null,null,null);e["a"]=b.exports}}]);
//# sourceMappingURL=chunk-bd74b288.b8d0df0f.js.map